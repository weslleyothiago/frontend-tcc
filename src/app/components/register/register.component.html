<ion-header class="ion-no-border flex">
  <ion-title class="font-japa p-8 text-center" style="font-size: x-large">
    Daisuke Karaokê
  </ion-title>
  <button
    (click)="closeModal()"
    aria-label="Fechar modal"
    class="group absolute top-4 right-4 flex items-center justify-center w-8 h-8 bg-transparent rounded-full transition duration-300 ease-in-out"
  >
    <div class="relative w-8 h-8 flex items-center justify-center bg-transparent rounded-full transition duration-300 ease-in-out group-hover:bg-white group-hover:bg-opacity-20">
      <div class="absolute top-1/2 left-1/2 w-4 h-0.5 bg-white rotate-45 transform -translate-x-1/2 -translate-y-1/2 rounded-full transition duration-300 ease-in-out group-hover:bg-purple-600"></div>
      <div class="absolute top-1/2 left-1/2 w-4 h-0.5 bg-white -rotate-45 transform -translate-x-1/2 -translate-y-1/2 rounded-full transition duration-300 ease-in-out group-hover:bg-purple-600"></div>
    </div>
    <span class="absolute left-1/2 bottom-[-30px] -translate-x-1/2 opacity-0 text-xs text-white bg-gray-700 px-1 py-1 rounded transition-opacity duration-300 ease-in-out group-hover:opacity-100 group-hover:delay-500 pointer-events-none whitespace-nowrap">
      Fechar
    </span>
  </button>
</ion-header>

<ion-content>
  <ng-container [ngTemplateOutlet]="getTemplate()"></ng-container>

  <ng-template #emailScreen>
    <div class="container items-center flex flex-col">
      <ion-title class="mt-0 text-base">
        Registre-se agora para começar a aproveitar!
      </ion-title>
      <div class="flex flex-col items-center w-5/6 m-4">
        <div class="w-5/6 h-0.5 grid grid-cols-3 mt-0 relative">
          <!-- Colored part of the line -->
          <div class="bg-purple-600 col-span-1 animated-bar"></div>
        
          <!-- Remaining part of the line -->
          <div class="bg-gray-400 col-span-2"></div>
        </div>

        <div class="flex flex-col w-5/6 justify-start mt-4">
          <span class="text-gray-400">Etapa 1 de 3</span>
          <span class="font-semibold">Escolha sua forma de cadastro</span>
        </div>

        <ion-button
          shape="round"
          class="mt-6 w-5/6 h-12"
          fill="outline"
          (click)="registerWithGoogle()"
          color="light"
        >
          <ion-icon slot="start" name="logo-google"></ion-icon>
          Registre-se com o Google
        </ion-button>

        <form
          [formGroup]="registrationForm"
          class="w-full flex flex-col items-center"
        >
          <div class="flex items-center w-5/6 mt-2">
            <hr class="flex-grow border-t border-gray-400" />
            <span class="mx-4 text-gray-500">ou</span>
            <hr class="mx-0 flex-grow border-t border-gray-400" />
          </div>
          <ion-input
            name="email"
            formControlName="email"
            label="Email"
            label-placement="floating"
            fill="solid"
            placeholder="nome@dominio.com"
            class="w-5/6 mt-4"
            (input)="checkEmailAvailability()"
          ></ion-input>

          <!-- Email field validations -->
          <div *ngIf="registrationForm.controls['email']?.touched" class="mt-2 w-5/6">
            <ion-text *ngIf="registrationForm.controls['email']?.hasError('required')" color="danger" class="flex items-baseline text-base">
              <ion-icon name="alert-circle" class="mr-2"></ion-icon>
              O campo de email é obrigatório.
            </ion-text>

            <ion-text *ngIf="registrationForm.controls['email']?.hasError('pattern')" color="danger" class="flex items-baseline text-base">
              <ion-icon name="alert-circle" class="mr-2"></ion-icon>
              Este e-mail é inválido. O formato correto é: exemplo&#64;email.com
            </ion-text>

            <ion-text *ngIf="emailExists" color="danger" class="flex items-baseline text-base">
              <ion-icon name="alert-circle" class="mr-2"></ion-icon>
              Este endereço já está vinculado a uma conta existente. Para continuar, faça login.
            </ion-text>
          </div>

          <ion-button
            shape="round"
            class="mt-6 w-5/6 h-12"
            [disabled]="registrationForm.get('email')?.invalid || emailExists"
            (click)="activateTemplate('passwordScreen')"
          >
            Próximo
          </ion-button>
        </form>
      </div>
    </div>
  </ng-template>

  <!-- Similar changes should be done for the other templates as well -->
</ion-content>
